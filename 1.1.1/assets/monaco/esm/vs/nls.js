var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};let isPseudo="undefined"!=typeof document&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;const DEFAULT_TAG="i-default";function _format(message,args){let result;return result=0===args.length?message:message.replace(/\{(\d+)\}/g,((match,rest)=>{const index=rest[0],arg=args[index];let result=match;return"string"==typeof arg?result=arg:"number"!=typeof arg&&"boolean"!=typeof arg&&null!=arg||(result=String(arg)),result})),isPseudo&&(result="［"+result.replace(/[aouei]/g,"$&$&")+"］"),result}function findLanguageForModule(config,name){let result=config[name];return result||(result=config["*"],result||null)}function endWithSlash(path){return"/"===path.charAt(path.length-1)?path:path+"/"}function getMessagesFromTranslationsService(translationServiceUrl,language,name){return __awaiter(this,void 0,void 0,(function*(){const url=endWithSlash(translationServiceUrl)+endWithSlash(language)+"vscode/"+endWithSlash(name),res=yield fetch(url);if(res.ok){return yield res.json()}throw new Error(`${res.status} - ${res.statusText}`)}))}function createScopedLocalize(scope){return function(idx,defaultValue){const restArgs=Array.prototype.slice.call(arguments,2);return _format(scope[idx],restArgs)}}export function localize(data,message,...args){return _format(message,args)}export function getConfiguredDefaultLocale(_){}export function setPseudoTranslation(value){isPseudo=value}export function create(key,data){var _a;return{localize:createScopedLocalize(data[key]),getConfiguredDefaultLocale:null!==(_a=data.getConfiguredDefaultLocale)&&void 0!==_a?_a:_=>{}}}export function load(name,req,load,config){var _a;const pluginConfig=null!==(_a=config["vs/nls"])&&void 0!==_a?_a:{};if(!name||0===name.length)return load({localize,getConfiguredDefaultLocale:()=>{var _a;return null===(_a=pluginConfig.availableLanguages)||void 0===_a?void 0:_a["*"]}});const language=pluginConfig.availableLanguages?findLanguageForModule(pluginConfig.availableLanguages,name):null,useDefaultLanguage=null===language||"i-default"===language;let suffix=".nls";useDefaultLanguage||(suffix=suffix+"."+language);const messagesLoaded=messages=>{Array.isArray(messages)?messages.localize=createScopedLocalize(messages):messages.localize=createScopedLocalize(messages[name]),messages.getConfiguredDefaultLocale=()=>{var _a;return null===(_a=pluginConfig.availableLanguages)||void 0===_a?void 0:_a["*"]},load(messages)};"function"==typeof pluginConfig.loadBundle?pluginConfig.loadBundle(name,language,((err,messages)=>{err?req([name+".nls"],messagesLoaded):messagesLoaded(messages)})):pluginConfig.translationServiceUrl&&!useDefaultLanguage?(()=>{__awaiter(this,void 0,void 0,(function*(){var _b;try{const messages=yield getMessagesFromTranslationsService(pluginConfig.translationServiceUrl,language,name);return messagesLoaded(messages)}catch(err){if(!language.includes("-"))return console.error(err),req([name+".nls"],messagesLoaded);try{const genericLanguage=language.split("-")[0],messages=yield getMessagesFromTranslationsService(pluginConfig.translationServiceUrl,genericLanguage,name);return null!==(_b=pluginConfig.availableLanguages)&&void 0!==_b||(pluginConfig.availableLanguages={}),pluginConfig.availableLanguages["*"]=genericLanguage,messagesLoaded(messages)}catch(err){return console.error(err),req([name+".nls"],messagesLoaded)}}}))})():req([name+suffix],messagesLoaded,(err=>{".nls"!==suffix?(console.error(`Failed to load message bundle for language ${language}. Falling back to the default language:`,err),req([name+".nls"],messagesLoaded)):console.error("Failed trying to load default language strings",err)}))}