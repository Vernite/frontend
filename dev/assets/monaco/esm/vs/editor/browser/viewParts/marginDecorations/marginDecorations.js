import"./marginDecorations.css";import{DecorationToRender,DedupOverlay}from"../glyphMargin/glyphMargin.js";export class MarginViewLineDecorationsOverlay extends DedupOverlay{constructor(context){super(),this._context=context,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(ctx){const decorations=ctx.getDecorationsInViewport(),r=[];let rLen=0;for(let i=0,len=decorations.length;i<len;i++){const d=decorations[i],marginClassName=d.options.marginClassName;marginClassName&&(r[rLen++]=new DecorationToRender(d.range.startLineNumber,d.range.endLineNumber,marginClassName))}return r}prepareRender(ctx){const visibleStartLineNumber=ctx.visibleRange.startLineNumber,visibleEndLineNumber=ctx.visibleRange.endLineNumber,toRender=this._render(visibleStartLineNumber,visibleEndLineNumber,this._getDecorations(ctx)),output=[];for(let lineNumber=visibleStartLineNumber;lineNumber<=visibleEndLineNumber;lineNumber++){const lineIndex=lineNumber-visibleStartLineNumber,classNames=toRender[lineIndex];let lineOutput="";for(let i=0,len=classNames.length;i<len;i++)lineOutput+='<div class="cmdr '+classNames[i]+'" style=""></div>';output[lineIndex]=lineOutput}this._renderResult=output}render(startLineNumber,lineNumber){return this._renderResult?this._renderResult[lineNumber-startLineNumber]:""}}