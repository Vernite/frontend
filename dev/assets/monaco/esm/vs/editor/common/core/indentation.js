import*as strings from"../../../base/common/strings.js";import{CursorColumns}from"./cursorColumns.js";function _normalizeIndentationFromWhitespace(str,indentSize,insertSpaces){let spacesCnt=0;for(let i=0;i<str.length;i++)"\t"===str.charAt(i)?spacesCnt=CursorColumns.nextIndentTabStop(spacesCnt,indentSize):spacesCnt++;let result="";if(!insertSpaces){const tabsCnt=Math.floor(spacesCnt/indentSize);spacesCnt%=indentSize;for(let i=0;i<tabsCnt;i++)result+="\t"}for(let i=0;i<spacesCnt;i++)result+=" ";return result}export function normalizeIndentation(str,indentSize,insertSpaces){let firstNonWhitespaceIndex=strings.firstNonWhitespaceIndex(str);return-1===firstNonWhitespaceIndex&&(firstNonWhitespaceIndex=str.length),_normalizeIndentationFromWhitespace(str.substring(0,firstNonWhitespaceIndex),indentSize,insertSpaces)+str.substring(firstNonWhitespaceIndex)}