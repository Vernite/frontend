import{VSBuffer}from"./buffer.js";import{URI}from"./uri.js";export function parse(text){let data=JSON.parse(text);return data=revive(data),data}export function revive(obj,depth=0){if(!obj||depth>200)return obj;if("object"==typeof obj){switch(obj.$mid){case 1:return URI.revive(obj);case 2:return new RegExp(obj.source,obj.flags);case 14:return new Date(obj.source)}if(obj instanceof VSBuffer||obj instanceof Uint8Array)return obj;if(Array.isArray(obj))for(let i=0;i<obj.length;++i)obj[i]=revive(obj[i],depth+1);else for(const key in obj)Object.hasOwnProperty.call(obj,key)&&(obj[key]=revive(obj[key],depth+1))}return obj}